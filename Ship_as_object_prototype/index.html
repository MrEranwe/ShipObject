

<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>Bare - Start Bootstrap Template</title>

    <!-- Bootstrap Core CSS -->
    <link href="css/bootstrap.min.css" rel="stylesheet">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

</head>

<body>

    <!-- Navigation -->
    <nav class="navbar navbar-inverse" role="navigation">
        <div class="container">
            <!-- Add  the <div>[Something]</div> structure for each header in the navbar-->
            <div class="navbar-header">               
                <a class="navbar-brand" href="index.html">Ship as an object</a>
            </div>
            <div class="navbar-header">
                <a class="navbar-brand" href="about.html">About</a>
            </div>
            <!-- This is for the right part of the navbar. Reserved for Shiplab logo-->
            <div class="nav navbar-nav navbar-right">
                <div class="navbar-header">
                    <a class="navbar-brand" href="http://www.shiplab.hials.org/"><img src="barquinho.png" style="height:150%"> 
                    </a>                    
                </div>
            </div>
        </div>
    </nav>


    <!-- Page Content -->
    
    <!-- Container creates the space -->
    <div class="container">
        
        <!-- Row creates horizontal groups of columns -->
        <div class="row">
            
            <!-- choose horizontal layout in https://www.w3schools.com/bootstrap/bootstrap_grid_examples.asp-->
            
            <!-- No divisions in page. Only 1 column. -->
             <div class="col-md-12 text-center">
                <h2>Ship as an object</h2>

            </div>  
            
            <div class="col-md-12 text-left">
                <h2>Input</h2>
                <textarea id="myTextArea" style="width:100%; height:300px"></textarea>
                <button onclick="updateValues()">Update values</button>
            </div>
            <div class="col-md-12 text-left">
                <h2>Output</h2>
                <pre id="json"></pre>
                <h3>Operations</h3>
                <button onclick="ShipA.CostFn()">Calculate Cost</button>
                <p>Total Cost: <span id="TotalCost"></span></p>
                <p>Elements with no Cost: <span id="NoCost"></span></p>
                <button onclick="ShipA.LCGFn()">Calculate LCG</button>
                <p>Position: [<span id="LCGx"></span>,<span id="LCGy"></span>,<span id="LCGz"></span>]</p>
                <button onclick="plot3d()">Plot Ship</button>
                <div id="myDiv"></div>
            </div>
        
        </div>
            
       
        

    </div>
    
    <script>
        function Vessel(name) {
            this.name = name;
            this.VesselData = {
                        "Length":100, 
                        "Breadth":30, 
                        "Depth":8, 
                        "Draft":5, 
                        "BlockCoefficient":0.75, 
                        "PrismaticCoefficient":0.8}
            this.ObjectsData = {
                        "Engine1":{
                            "General":{
                                "Type": "Engine", 
                                "Length":2, 
                                "Width":4, 
                                "Height":2, 
                                "Weight":500, 
                                "Position":[-40, 10, -2]
                            }, 
                            "Capabilities": {
                                "RPM": 500
                            }, 
                            "Cost": 100
                        },
                        "Engine2":{
                            "General":{
                                "Type": "Engine", 
                                "Length":2, 
                                "Width":4, 
                                "Height":2, 
                                "Weight":500, 
                                "Position":[-40, -10, -2]
                            }, 
                            "Capabilities": {
                                "RPM": 500}, 
                            "Cost": 600
                        },
                        "Tank":{
                            "General":{
                                "Type": "Tank", 
                                "Length":50, 
                                "Width":25, 
                                "Height":7, 
                                "Weight":1000, 
                                "Position":[10, 0, 0]
                            }, 
                            "Capabilities": {
                                "Cargo": "LNG"
                            }, 
                            "Cost": 0}
                    }
            this.HullData = {
                        "Offsets":{
                            "Data":[1, 2, 3]
                        }
                    }
            this.CostFn = function(){
                        var TotalCost = 0
                        var NoCost = "The elements with no cost are: "
                        for (var key1 in ShipA.ObjectsData){ 
                            if (!ShipA.ObjectsData.hasOwnProperty(key1)) continue;
                            var obj1 = ShipA.ObjectsData[key1];
                            for (var key2 in obj1){
                                if (!obj1.hasOwnProperty(key2)) continue;
                                if (obj1.Cost > 0){
                                var SumCost = obj1.Cost
                                } 
                                else if (obj1.Cost === 0) {
                                var SumNoCost = key1
                                var SumCost = 0
                                
                                }
                                                               
                            }
                            TotalCost = SumCost + TotalCost
                            if (SumNoCost !== undefined){
                                var NoCost = NoCost + SumNoCost + ", "
                                console.log(NoCost)
                            }
                        
                            SumCost = 0
                    }
                
                if (NoCost === undefined){
                    NoCost = "No one"
                }
                document.getElementById("TotalCost").innerHTML = TotalCost;
                document.getElementById("NoCost").innerHTML = NoCost;
                    }
            this.LCGFn = function(){
                var lcgax = 0
                var lcgay = 0
                var lcgaz = 0
                var totweight = 0
                for (var key1 in ShipA.ObjectsData){ 
                    if (!ShipA.ObjectsData.hasOwnProperty(key1)) continue;
                        var obj1 = ShipA.ObjectsData[key1];
                        for (var key2 in obj1){
                            if (!obj1.hasOwnProperty(key2)) continue;
                            var obj2 = obj1[key2]
                            for (var key3 in obj2){
                                if (!obj2.hasOwnProperty("Position")) continue;
                                var lcg = obj2.Position
                                var weight = obj2.Weight

                            }

                        }
                    var totweight = weight + totweight
                    console.log(totweight)
                    var lcgwx = weight * lcg[0]
                    var lcgwy = weight * lcg[1]
                    var lcgwz = weight * lcg[2]
                    lcgax = lcgwx + lcgax
                    lcgay = lcgwy + lcgay
                    lcgaz = lcgwz + lcgaz

                }
                lcgx = lcgax / totweight
                lcgy = lcgay / totweight
                lcgz = lcgaz / totweight
                document.getElementById("LCGx").innerHTML = lcgx
                document.getElementById("LCGy").innerHTML = lcgy
                document.getElementById("LCGz").innerHTML = lcgz
                
            }
            this.PlotFn = function(){
                var a = [0, 0, 0,  0, ShipA.VesselData.Length, ShipA.VesselData.Length,ShipA.VesselData.Length,ShipA.VesselData.Length]
                var b = [0, 0, ShipA.VesselData.Breadth/2, ShipA.VesselData.Breadth/2,0, 0, ShipA.VesselData.Breadth/2, ShipA.VesselData.Breadth/2]
                var c = [0, ShipA.VesselData.Depth, 0, ShipA.VesselData.Depth, 0, ShipA.VesselData.Depth, 0, ShipA.VesselData.Depth]
                var data =[{
                    x: a,
                    y: b,
                    z: c,
                    mode: "markers",
                    type: "scatter3d",
                    marker: {
                    color: "rgb(23, 190, 207)",
                    size: 2
                   }},{
                     alphahull: 7,
                     opacity: 0.1,
                     type: 'mesh3d',
                     x: a,
                     y: b,
                     z: c
                }]
                var layout = {
                    autosize: false,
                    height: 480,
                    scene: {
                        aspectratio: {
                            x: 1,
                            y: 1,
                            z: 1
                        },
                        camera: {
                            center: {
                                x: 0,
                                y: 0,
                                z: 0
                            },
                            eye: {
                                x: 1.25,
                                y: 1.25,
                                z: 1.25
                            },
                            up: {
                                x: 0,
                                y: 0,
                                z: 1
                            }
                        },
                        xaxis: {
                            type: 'linear',
                            zeroline: false
                        },
                        yaxis: {
                            type: 'linear',
                            zeroline: false
                        },
                        zaxis: {
                            type: 'linear',
                            zeroline: false
                        }
                    }
                    }
                Plotly.newPlot("myDiv", data, layout)

        }

        }
        var ShipA = new Vessel ("A")
        console.log(ShipA)        

        /*// Calculate cost function
        function CostFn(){
            var TotalCost = 0
            for (var key1 in myJsObj.ShipA.ObjectsData){ 
                if (!myJsObj.ShipA.ObjectsData.hasOwnProperty(key1)) continue;
                    var obj1 = myJsObj.ShipA.ObjectsData[key1];
                    for (var key2 in obj1){
                        if (!obj1.hasOwnProperty(key2)) continue;
                            if (obj1.Cost > 0){
                                var SumCost = obj1.Cost
                                
                            } 
                            else {
                            var NoCost = key1
                            }                                
                        
                        }
                TotalCost = SumCost + TotalCost
                SumCost = 0
            }
            document.getElementById("TotalCost").innerHTML = TotalCost;
            document.getElementById("NoCost").innerHTML = NoCost;
        }
        
        // Calculate LCG function
        function LCGFn(){
            var lcgax = 0
            var lcgay = 0
            var lcgaz = 0
            var totweight = 0
            for (var key1 in myJsObj.ShipA.ObjectsData){ 
                if (!myJsObj.ShipA.ObjectsData.hasOwnProperty(key1)) continue;
                    var obj1 = myJsObj.ShipA.ObjectsData[key1];
                    for (var key2 in obj1){
                        if (!obj1.hasOwnProperty(key2)) continue;
                        var obj2 = obj1[key2]
                        for (var key3 in obj2){
                            if (!obj2.hasOwnProperty("Position")) continue;
                            var lcg = obj2.Position
                            var weight = obj2.Weight
                            
                        }
                        
                    }
                var totweight = weight + totweight
                console.log(totweight)
                var lcgwx = weight * lcg[0]
                var lcgwy = weight * lcg[1]
                var lcgwz = weight * lcg[2]
                lcgax = lcgwx + lcgax
                lcgay = lcgwy + lcgay
                lcgaz = lcgwz + lcgaz

            }
            lcgx = lcgax / totweight
            lcgy = lcgay / totweight
            lcgz = lcgaz / totweight
            document.getElementById("LCGx").innerHTML = lcgx
            document.getElementById("LCGy").innerHTML = lcgy
            document.getElementById("LCGz").innerHTML = lcgz
        }
        */
            
        // using JSON.stringify pretty print capability:
        var str = JSON.stringify(ShipA, undefined, 4);

        // display pretty printed object in text area:
        document.getElementById('myTextArea').innerHTML = str;

        // Function for updating values
        function updateValues() 
        {
            
            var ugly = document.getElementById('myTextArea').value;
            ShipUp = JSON.parse(ugly);
            var pretty = JSON.stringify(ShipUp, undefined, 4);
            ShipA.VesselData = ShipUp.VesselData
            ShipA.ObjectsData = ShipUp.ObjectsData
            ShipA.HullData = ShipUp.HullData
            console.log(ShipA)
            document.getElementById('myTextArea').value = pretty;  
            document.getElementById("json").innerHTML = JSON.stringify(ShipUp, undefined, 4);
            
        }
        function cleanArray(actual) {
          var newArray = new Array();
          for (var i = 0; i < actual.length; i++) {
            if (actual[i]) {
              newArray.push(actual[i]);
            }
          }
          return newArray;
        } 
        
        function plot3d (){
            var data =[{
                type: "scatter3d",
                mode: "lines",
                x: [0, ShipA.VesselData.Length, ShipA.VesselData.Length, 0, 0, 0, ShipA.VesselData.Length, ShipA.VesselData.Length, ShipA.VesselData.Length, ShipA.VesselData.Length, ShipA.VesselData.Length, ShipA.VesselData.Length, 0, 0, 0, 0],
                y: [0, 0, ShipA.VesselData.Breadth, ShipA.VesselData.Breadth, 0, 0, 0, 0, 0,  ShipA.VesselData.Breadth, ShipA.VesselData.Breadth, ShipA.VesselData.Breadth, ShipA.VesselData.Breadth, ShipA.VesselData.Breadth, ShipA.VesselData.Breadth, 0],
                z: [0, 0, 0, 0, 0, ShipA.VesselData.Draft, ShipA.VesselData.Draft, 0, ShipA.VesselData.Draft, ShipA.VesselData.Draft, 0, ShipA.VesselData.Draft, ShipA.VesselData.Draft, 0, ShipA.VesselData.Draft, ShipA.VesselData.Draft]
            }]
            var layout = {
              scene:{
                aspectmode: "manual",
                aspectratio: {
                 x: 1, y: 0.7, z: 1,
                },
               xaxis: {
                nticks: 10,
                range: [-ShipA.VesselData.Length, ShipA.VesselData.Length*2],
              },
               yaxis: {
                nticks: 10,
                range: [-ShipA.VesselData.Breadth, ShipA.VesselData.Breadth*2],
              },
               zaxis: {
               nticks: 10,
               range: [-ShipA.VesselData.Draft, ShipA.VesselData.Draft*2],
              }},
            };
            
            Plotly.plot("myDiv", data, layout, {})
        }
 
 
    </script>
    <!-- /.container -->
    
    <!-- Plotly.js -->
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    
    <!-- Insert own scripts here -->
      

    <!-- jQuery Version 1.11.1 -->
    <script src="js/jquery.js"></script>

    <!-- Bootstrap Core JavaScript -->
    <script src="js/bootstrap.min.js"></script>

</body>

</html>
